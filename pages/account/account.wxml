<!--pages/account/account.wxml - è´¦æˆ·ä½™é¢é¡µé¢-->
<view class="page">
  <!-- é¡¶éƒ¨ä½™é¢å¡ç‰‡ -->
  <view class="balance-card">
    <view class="balance-label">è´¦æˆ·ä½™é¢</view>
    <view class="balance-value">Â¥{{account.balance.toFixed(2)}}</view>
    <view class="balance-hint">å¯ç”¨äºæ”¯ä»˜ç»´ä¿®è´¹ç”¨</view>

    <!-- å……å€¼æŒ‰é’® -->
    <button class="recharge-btn" bindtap="onRecharge">
      <text class="btn-icon">ğŸ’°</text>
      ç«‹å³å……å€¼
    </button>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-container">
    <view class="stat-item">
      <view class="stat-value">{{stats.totalOrders}}</view>
      <view class="stat-label">æ€»è®¢å•æ•°</view>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <view class="stat-value">Â¥{{stats.totalSpent.toFixed(2)}}</view>
      <view class="stat-label">ç´¯è®¡æ¶ˆè´¹</view>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <view class="stat-value">{{stats.pendingOrders}}</view>
      <view class="stat-label">å¾…å¤„ç†</view>
    </view>
  </view>

  <!-- äº¤æ˜“è®°å½• -->
  <view class="transactions-section">
    <view class="section-header">
      <view class="section-title">äº¤æ˜“è®°å½•</view>
      <view class="section-filter" bindtap="onFilter">
        <text>{{filterText}}</text>
        <text class="filter-icon">â–¼</text>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{!loading && transactions.length === 0}}">
      <text class="empty-icon">ğŸ’³</text>
      <text class="empty-text">æš‚æ— äº¤æ˜“è®°å½•</text>
    </view>

    <!-- äº¤æ˜“åˆ—è¡¨ -->
    <view class="transaction-list" wx:if="{{transactions.length > 0}}">
      <view
        class="transaction-item"
        wx:for="{{transactions}}"
        wx:key="_id"
        bindtap="onTransactionDetail"
        data-item="{{item}}"
      >
        <view class="transaction-icon {{item.type === 'recharge' ? 'income' : 'expense'}}">
          {{item.type === 'recharge' ? 'â†“' : 'â†‘'}}
        </view>
        <view class="transaction-info">
          <view class="transaction-title">{{item.description}}</view>
          <view class="transaction-time">{{item.createdAtText}}</view>
        </view>
        <view class="transaction-amount {{item.type === 'recharge' ? 'income' : 'expense'}}">
          {{item.type === 'recharge' ? '+' : '-'}}Â¥{{item.amount.toFixed(2)}}
        </view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="loading-more" wx:if="{{loading}}">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
  </view>
</view>
