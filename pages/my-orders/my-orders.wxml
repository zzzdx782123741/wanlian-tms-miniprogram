<!--pages/my-orders/my-orders.wxml - æˆ‘çš„è®¢å•é¡µé¢ï¼ˆæ”¯æŒæ‰€æœ‰è§’è‰²ï¼‰-->
<view class="page">
  <!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
  <view class="header">
    <view class="header-title">æˆ‘çš„è®¢å•</view>
    <view class="header-subtitle">æŸ¥çœ‹å’Œç®¡ç†ç»´ä¿®è®¢å•</view>
  </view>

  <!-- çŠ¶æ€ç­›é€‰æ ‡ç­¾ -->
  <view class="filter-tabs">
    <view
      class="tab-item {{activeTab === 'all' ? 'active' : ''}}"
      data-tab="all"
      bindtap="onTabChange"
    >
      <text class="tab-text">å…¨éƒ¨</text>
    </view>
    <view
      class="tab-item {{activeTab === 'pending_assessment' ? 'active' : ''}}"
      data-tab="pending_assessment"
      bindtap="onTabChange"
    >
      <text class="tab-text">å¾…è¯„ä¼°</text>
    </view>
    <view
      class="tab-item {{activeTab === 'awaiting_approval' ? 'active' : ''}}"
      data-tab="awaiting_approval"
      bindtap="onTabChange"
    >
      <text class="tab-text">å®¡æ‰¹ä¸­</text>
    </view>
    <view
      class="tab-item {{activeTab === 'in_repair' ? 'active' : ''}}"
      data-tab="in_repair"
      bindtap="onTabChange"
    >
      <text class="tab-text">ç»´ä¿®ä¸­</text>
    </view>
    <view
      class="tab-item {{activeTab === 'completed' ? 'active' : ''}}"
      data-tab="completed"
      bindtap="onTabChange"
    >
      <text class="tab-text">å·²å®Œæˆ</text>
    </view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="order-list">
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{!loading && orders.length === 0}}">
      <text class="empty-icon">ğŸ”§</text>
      <text class="empty-text">æš‚æ— è®¢å•</text>
    </view>

    <!-- è®¢å•å¡ç‰‡ -->
    <view
      class="order-card"
      wx:for="{{orders}}"
      wx:key="_id"
      bindtap="onOrderTap"
      data-id="{{item._id}}"
    >
      <!-- è®¢å•çŠ¶æ€æ ‡ç­¾ -->
      <view class="order-status status-{{item.status}}">
        {{item.statusText}}
      </view>

      <!-- è®¢å•å¤´éƒ¨ -->
      <view class="order-header">
        <view class="order-number">{{item.orderNumber}}</view>
        <view class="order-time">{{item.createdAtText}}</view>
      </view>

      <!-- è½¦è¾†ä¿¡æ¯ -->
      <view class="order-vehicle">
        <text class="vehicle-icon">ğŸšš</text>
        <view class="vehicle-info">
          <view class="vehicle-plate">{{item.vehicleId.plateNumber}}</view>
          <view class="vehicle-model">{{item.vehicleId.brand}} {{item.vehicleId.model}}</view>
        </view>
      </view>

      <!-- æ•…éšœæè¿° -->
      <view class="order-fault">
        <text class="fault-label">æ•…éšœï¼š</text>
        <text class="fault-text">{{item.faultDescription}}</text>
      </view>

      <!-- æŠ¥ä»·ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰ -->
      <view class="order-quote" wx:if="{{item.quote}}">
        <text class="quote-label">æŠ¥ä»·ï¼š</text>
        <text class="quote-price">Â¥{{item.quote.total}}</text>
      </view>

      <!-- è¿›åº¦æç¤º -->
      <view class="order-progress-hint" wx:if="{{item.nextAction}}">
        <text class="hint-icon">ğŸ’¡</text>
        <text class="hint-text">{{item.nextAction}}</text>
      </view>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-state" wx:if="{{loading}}">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
  </view>
</view>
